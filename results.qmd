# Results

```{r, echo = FALSE, message = FALSE, warning = FALSE, cache = FALSE}
if (!require("writexl")) install.packages("writexl")
library(readxl)
library(dplyr)
library(scales)
library(writexl)

# Load the Excel file
file_path <- "./data/SOWC-2023-Statistical-tables-All-EN.xlsx"

# Get the names of all sheets
sheet_names <- excel_sheets(file_path)

# Function to calculate mode
Mode <- function(x) {
  ux <- unique(x)
  ux[which.max(tabulate(match(x, ux)))]
}

# Function to preprocess a single sheet
preprocess_sheet <- function(sheet_name) {
  df <- read_excel(file_path, sheet = sheet_name)

  # Handling missing values: Fill numeric missing values with median and categorical with mode
  df <- df %>% mutate(across(where(is.numeric), ~ifelse(is.na(.), median(., na.rm = TRUE), .)))
  df <- df %>% mutate(across(where(is.factor), ~ifelse(is.na(.), Mode(.), .)))

  # Normalization: Apply Min-Max scaling to numeric columns
  df <- df %>% mutate(across(where(is.numeric), ~rescale(., to = c(0, 1))))

  return(df)
}

# Apply preprocessing to all sheets and store in a named list
preprocessed_data <- setNames(object = lapply(sheet_names, preprocess_sheet),
                              nm = sheet_names)

# Define the path for the new Excel file
# new_file_path <- "./data/Preprocessed_SOWC-2023-Statistical-tables-All-EN.xlsx"

# Write each preprocessed data frame to a new Excel file
# write_xlsx(preprocessed_data, path = new_file_path, col_names = TRUE)

# Confirmation message
# cat("Preprocessed data saved to", new_file_path)
```



1. Bar Chart (10 Most Populous Countries)
```{r, echo = FALSE, message = FALSE, warning = FALSE, cache = FALSE}
# Load the Excel file
file_path <- "./data/SOWC-2023-Statistical-tables-All-EN.xlsx"
sheet_name <- "6. HIV AIDS Epidemiology"

# Reading the sheet
data <- readxl::read_excel(file_path, sheet = sheet_name)

```

